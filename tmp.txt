
yum update xfsprogs -y

http://docker-snake.cn-bj.ufileos.com/container-selinux-2.74-1.el7.noarch.rpm

http://docker-snake.cn-bj.ufileos.com/docker-ce-18.03.1.ce-1.el7.centos.x86_64.rpm



yum -y install policycoreutils-python selinux-policy-base selinux-policy-targeted libseccomp libtool-ltdl device-mapper-libs pigz lvm2 yum-plugin-ovl


tee /etc/docker/daemon.json <<-'EOF'
{"registry-mirrors":["https://registry.docker-cn.com"],"log-driver":"json-file","log-opts":{"max-size":"5m"},"storage-driver":"overlay2","storage-opts":["overlay2.override_kernel_check=true"]}
EOF



"storage-opts":["overlay2.override_kernel_check=true"


curl http://docker-snake.cn-bj.ufileos.com/update_kernel.sh | bash

curl http://docker-snake.cn-bj.ufileos.com/install_docker_18_03.sh | bash


mount /dev/vdb /data/



 yum-utils device-mapper-persistent-data policycoreutils-python selinux-policy-base selinux-policy-targeted libseccomp libtool-ltdl device-mapper-libs pigz lvm2 yum-plugin-ovl
 
 
 
d_type查看
xfs_info /
 
查看磁盘文件系统类型
parted -l


格式化
fdisk -l
mkfs.ext4 设备
mkfs.ext4 /dev/sdb1

mkfs.xfs -n ftype=1 /dev/mapper/centos-root  //重新格式化device，在此
mkfs.xfs -n ftype=1 /dev/vda



vi /lib/systemd/system/docker.service

-H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock

systemctl daemon-reload


#初始化
docker swarm init --advertise-addr 10.25.10.163
SWMTKN-1-1kbytqsyjtli738z2irxueb3bg6bfdnn7bzgp0npahral6sgrd-5avh9yu024972c1rbjgszdeh5 10.25.10.163:2377

#加入集群
docker swarm join --token SWMTKN-1-1kbytqsyjtli738z2irxueb3bg6bfdnn7bzgp0npahral6sgrd-5avh9yu024972c1rbjgszdeh5 10.25.10.163:2377
